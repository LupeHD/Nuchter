<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Track je nuchtere dagen en zie dagelijks positieve gezondheidsvoordelen">
  <meta name="theme-color" content="#10b981">
  <title>More Sober Days</title>
  
  <style>
    /* Definieer kleurvariabelen voor de thema's */
    :root {
      /* Standaard Groen (Emerald) */
      --bg-gradient-1: #f0fdf4;
      --bg-gradient-2: #ecfdf5;
      --border-light: #d1fae5;
      --border-medium: #bbf7d0;
      --border-dark: #86efac;
      --text-accent: #059669;
      --text-accent-hover: #047857;
      --primary-main: #10b981;
      --primary-gradient-start: #10b981;
      --primary-gradient-end: #059669;
      --input-focus: #4ade80;
      --counter-1: #059669;
      --counter-2: #10b981;
      --counter-3: #14b8a6;
      --icon-bg-1: #d1fae5;
      --icon-bg-2: #a7f3d0;
    }

    /* Sportmodus Blauw (Sky) */
    body.sport-mode {
      --bg-gradient-1: #f0f9ff;
      --bg-gradient-2: #e0f2fe;
      --border-light: #e0f2fe;
      --border-medium: #bae6fd;
      --border-dark: #7dd3fc;
      --text-accent: #0284c7;
      --text-accent-hover: #0369a1;
      --primary-main: #0ea5e9;
      --primary-gradient-start: #0ea5e9;
      --primary-gradient-end: #0284c7;
      --input-focus: #38bdf8;
      --counter-1: #0284c7;
      --counter-2: #0ea5e9;
      --counter-3: #06b6d4;
      --icon-bg-1: #e0f2fe;
      --icon-bg-2: #bae6fd;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background: linear-gradient(to bottom right, var(--bg-gradient-1), #ffffff, var(--bg-gradient-2));
      min-height: 100vh;
      transition: background 0.3s ease;
    }

    .container {
      max-width: 896px;
      margin: 0 auto;
      padding: 1rem;
    }

    @media (min-width: 768px) {
      .container {
        padding: 2rem;
      }
    }

    /* --- Verbeterde Header CSS --- */
    .header {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border-light);
      position: sticky;
      top: 0;
      z-index: 50; /* Verhoogd voor zekerheid */
      transition: border-color 0.3s;
    }

    .header-content {
      max-width: 896px;
      margin: 0 auto;
      padding: 1rem;
      display: flex;
      flex-direction: column; /* Mobiel eerst: onder elkaar */
      align-items: center;
      gap: 1rem;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 300;
      color: #1f2937;
      text-align: center;
    }

    .header-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap; /* Zorgt dat knoppen naar volgende regel gaan als het te krap wordt */
      gap: 0.75rem;
      width: 100%;
    }

    /* Desktop aanpassingen voor header */
    @media (min-width: 768px) {
      .header-content {
        flex-direction: row; /* Naast elkaar op desktop */
        justify-content: space-between;
      }

      .header-title {
        text-align: left;
      }

      .header-controls {
        width: auto;
        justify-content: flex-end;
      }
    }

    .header-button {
      font-size: 0.875rem;
      color: var(--text-accent);
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
      padding: 0.5rem 1rem;
      border-radius: 2rem; /* Consistent maken met toggles */
      background-color: rgba(255, 255, 255, 0.5); /* Lichte achtergrond */
      border: 1px solid transparent;
    }

    .header-button:hover {
      color: var(--text-accent-hover);
      background-color: rgba(255, 255, 255, 0.9);
      border-color: var(--border-light);
    }

    .mode-toggle-container {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 2rem;
      border: 1px solid var(--border-light);
      transition: border-color 0.3s;
      /* Zorgt dat ze flexibel zijn op mobiel maar niet te klein */
      flex: 0 1 auto; 
    }

    .mode-toggle-label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.875rem;
      color: #374151;
      font-weight: 500;
      white-space: nowrap; /* Voorkomt dat tekst breekt */
    }

    .toggle-switch {
      position: relative;
      width: 3rem;
      height: 1.5rem;
      background: #e5e7eb;
      border-radius: 9999px;
      cursor: pointer;
      transition: background 0.3s;
      flex-shrink: 0; /* Voorkomt dat switch geplet wordt */
    }
    /* --- Einde Verbeterde Header CSS --- */

    .toggle-switch.active {
      background: var(--primary-main);
    }

    .toggle-slider {
      position: absolute;
      top: 0.125rem;
      left: 0.125rem;
      width: 1.25rem;
      height: 1.25rem;
      background: white;
      border-radius: 9999px;
      transition: transform 0.3s;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch.active .toggle-slider {
      transform: translateX(1.5rem);
    }

    .card {
      background: white;
      border-radius: 1.5rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      padding: 2rem;
      border: 1px solid var(--border-light);
      margin-bottom: 1.5rem;
      transition: border-color 0.3s;
    }

    @media (min-width: 768px) {
      .card {
        padding: 3rem;
      }
    }

    .card-hover {
      transition: transform 0.2s;
    }

    .card-hover:hover {
      transform: scale(1.02);
    }

    .center-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .date-picker-card {
      background: white;
      border-radius: 1.5rem;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      padding: 2rem;
      max-width: 28rem;
      width: 100%;
      border: 1px solid var(--border-light);
      position: relative; /* Voor het kruisje */
    }

    /* Nieuwe stijl voor het kruisje */
    .close-button {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #9ca3af;
      cursor: pointer;
      width: 2rem;
      height: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s;
    }

    .close-button:hover {
      background-color: #f3f4f6;
      color: #374151;
    }

    @media (min-width: 768px) {
      .date-picker-card {
        padding: 3rem;
      }
    }

    .icon-circle {
      display: inline-flex;
      padding: 1rem;
      background: linear-gradient(to bottom right, var(--icon-bg-1), var(--icon-bg-2));
      border-radius: 9999px;
      font-size: 2rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.3);
      transition: background 0.3s;
    }

    .icon-circle-small {
      display: inline-flex;
      padding: 0.75rem;
      background: linear-gradient(to bottom right, var(--icon-bg-1), var(--icon-bg-2));
      border-radius: 9999px;
      font-size: 1.5rem;
      transition: background 0.3s;
    }

    .icon-white {
      display: inline-flex;
      padding: 1rem;
      background: white;
      border-radius: 9999px;
      font-size: 2rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .title-large {
      font-size: 2rem;
      font-weight: 700;
      color: #111827;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
    }

    @media (min-width: 768px) {
      .title-large {
        font-size: 2.25rem;
      }
    }

    .subtitle {
      color: #6b7280;
      margin-bottom: 2rem;
    }

    .input-datetime {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid var(--border-medium);
      border-radius: 0.75rem;
      font-size: 1rem;
      margin-bottom: 1.5rem;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .input-datetime:focus {
      outline: none;
      border-color: var(--input-focus);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }

    body.sport-mode .input-datetime:focus {
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }

    .button-primary {
      width: 100%;
      padding: 0.875rem 1.5rem;
      background: linear-gradient(to right, var(--primary-gradient-start), var(--primary-gradient-end));
      color: white;
      border: none;
      border-radius: 0.75rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.2s;
    }

    .button-primary:hover:not(:disabled) {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .button-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .text-small {
      color: #9ca3af;
      font-size: 0.875rem;
      text-align: center;
      margin-top: 1rem;
    }

    .space-y > * + * {
      margin-top: 1.5rem;
    }

    .counter-title {
      font-size: 1.25rem;
      color: #6b7280;
      margin-bottom: 1.5rem;
    }

    .counter-grid {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      gap: 1.5rem;
    }

    @media (min-width: 640px) {
      .counter-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .counter-item {
      text-align: center;
    }

    .counter-number {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--counter-1), var(--counter-2));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
      transition: background 0.3s;
    }

    .counter-number-green {
      background: linear-gradient(135deg, var(--counter-1), var(--counter-2));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .counter-number-teal {
      background: linear-gradient(135deg, var(--counter-3), var(--counter-2));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    @media (min-width: 768px) {
      .counter-number {
        font-size: 4rem;
      }
    }

    .counter-label {
      color: #6b7280;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .divider {
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-light);
    }

    .next-milestone-label {
      text-align: center;
      color: #9ca3af;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 1rem;
    }

    .next-milestone-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .milestone-icon {
      font-size: 1.5rem;
    }

    .milestone-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #111827;
    }

    .milestone-remaining {
      color: #6b7280;
      font-size: 0.875rem;
    }

    .benefit-card {
      background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
      border-radius: 1.5rem;
      padding: 2rem;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      transition: background 0.3s;
    }

    .benefit-content {
      display: flex;
      gap: 1.5rem;
      align-items: flex-start;
    }

    @media (max-width: 640px) {
      .benefit-content {
        flex-direction: column;
        align-items: center;
        text-align: center;
      }
    }

    .benefit-text {
      flex: 1;
    }

    .benefit-title {
      color: white;
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    @media (min-width: 768px) {
      .benefit-title {
        font-size: 1.875rem;
      }
    }

    .benefit-description {
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.625;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
    }

    .milestone-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    @media (min-width: 768px) {
      .milestone-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .milestone-card {
      padding: 1.5rem;
      border-radius: 1rem;
      border: 2px solid;
      transition: all 0.2s;
    }

    .milestone-achieved {
      background: linear-gradient(to bottom right, var(--icon-bg-1), white);
      border-color: var(--border-dark);
    }

    .milestone-pending {
      background: #f9fafb;
      border-color: #e5e7eb;
    }

    .milestone-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .milestone-emoji {
      font-size: 1.5rem;
    }

    .milestone-name {
      flex: 1;
      font-weight: 600;
      color: #111827;
    }

    .milestone-badge {
      padding: 0.25rem 0.75rem;
      background: linear-gradient(to right, var(--primary-gradient-start), var(--primary-gradient-end));
      color: white;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .milestone-benefit {
      padding-top: 0.75rem;
      margin-top: 0.75rem;
      border-top: 1px solid var(--border-light);
    }

    .milestone-benefit-title {
      font-weight: 600;
      color: var(--text-accent);
      margin-bottom: 0.25rem;
    }

    .milestone-benefit-text {
      color: #6b7280;
      font-size: 0.875rem;
      line-height: 1.5;
    }

    .reset-card {
      background: #fef2f2;
      border-radius: 1.5rem;
      padding: 2rem;
      border: 1px solid #fecaca;
      text-align: center;
    }

    .reset-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #991b1b;
      margin-bottom: 1rem;
    }

    .button-danger {
      padding: 0.75rem 1.5rem;
      background: #dc2626;
      color: white;
      border: none;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .button-danger:hover {
      background: #b91c1c;
    }

    .confirm-text {
      color: #991b1b;
      margin-bottom: 1rem;
      font-weight: 500;
    }

    .button-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .button-confirm {
      padding: 0.75rem 1.5rem;
      background: #dc2626;
      color: white;
      border: none;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .button-confirm:hover {
      background: #b91c1c;
    }

    .button-cancel {
      padding: 0.75rem 1.5rem;
      background: #e5e7eb;
      color: #374151;
      border: none;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .button-cancel:hover {
      background: #d1d5db;
    }

    /* Shop styles */
    .shop-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    @media (min-width: 640px) {
      .shop-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 768px) {
      .shop-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    .shop-item {
      padding: 1.5rem;
      border-radius: 1rem;
      border: 2px solid var(--border-light);
      background: white;
      transition: all 0.2s;
      text-align: center;
    }

    .shop-item:hover {
      border-color: var(--border-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .shop-item-icon {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }

    .shop-item-name {
      font-weight: 600;
      color: #111827;
      margin-bottom: 0.5rem;
    }

    .shop-item-cost {
      color: var(--text-accent);
      font-weight: 700;
      font-size: 1.125rem;
      margin-bottom: 1rem;
    }

    .quantity-control {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .quantity-button {
      width: 2rem;
      height: 2rem;
      background: var(--border-light);
      border: 1px solid var(--border-medium);
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-weight: 700;
      font-size: 1.125rem;
      color: var(--text-accent);
      transition: all 0.2s;
    }

    .quantity-button:hover:not(:disabled) {
      background: var(--border-medium);
      transform: scale(1.05);
    }

    .quantity-button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .quantity-display {
      min-width: 2rem;
      text-align: center;
      font-weight: 600;
      font-size: 1.125rem;
      color: #111827;
    }

    .shop-button {
      width: 100%;
      padding: 0.625rem 1rem;
      background: linear-gradient(to right, var(--primary-gradient-start), var(--primary-gradient-end));
      color: white;
      border: none;
      border-radius: 0.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.2s;
    }

    .shop-button:hover:not(:disabled) {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    .shop-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      background: #9ca3af;
    }

    .purchase-message {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 0.75rem;
      text-align: center;
      font-weight: 600;
      animation: slideIn 0.3s ease-out;
    }

    .purchase-success {
      background: #d1fae5;
      color: #065f46;
      border: 1px solid #6ee7b7;
    }

    .purchase-error {
      background: #fee2e2;
      color: #991b1b;
      border: 1px solid #fca5a5;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script>
    let startDate = localStorage.getItem('sobrietyStartDate') || '';
    let sportMode = localStorage.getItem('sportMode') === 'true';
    let showShop = localStorage.getItem('showShop') === 'true';
    let showDatePicker = !startDate;
    let showResetConfirm = false;
    let tempDate = '';
    let purchaseMessage = '';
    let purchaseType = '';
    let shopQuantities = { beer: 1, wine: 1, cocktail: 1 };
    let savedPoints = parseInt(localStorage.getItem('savedPoints') || '0');
    let purchaseHistory = JSON.parse(localStorage.getItem('purchaseHistory') || '{"beer": 0, "wine": 0, "cocktail": 0}');
    
    // Punten systeem
    let achievedMilestones = JSON.parse(localStorage.getItem('achievedMilestones') || '[]');

    const timeElapsed = {
      days: 0,
      hours: 0,
      minutes: 0,
      seconds: 0
    };

    const milestones = [
      { days: 1, title: "1 Dag", icon: "üåü" },
      { days: 2, title: "2 Dagen", icon: "üí™" },
      { days: 3, title: "3 Dagen", icon: "‚ú®" },
      { days: 4, title: "4 Dagen", icon: "üçÉ" },
      { days: 5, title: "5 Dagen", icon: "üò¥" },
      { days: 7, title: "1 Week", icon: "üå±" },
      { days: 10, title: "10 Dagen", icon: "‚ú®" },
      { days: 14, title: "2 Weken", icon: "üåø" },
      { days: 21, title: "3 Weken", icon: "üß†" },
      { days: 30, title: "1 Maand", icon: "üå≥" },
      { days: 60, title: "2 Maanden", icon: "üíö" },
      { days: 90, title: "3 Maanden", icon: "üèÜ" },
      { days: 180, title: "6 Maanden", icon: "‚≠ê" },
      { days: 270, title: "9 Maanden", icon: "üíé" },
      { days: 365, title: "1 Jaar", icon: "üëë" }
    ];

    const benefits = [
      { day: 1, title: "Bloedsuiker stabiliseert", text: "Je bloedsuikerspiegel stabiliseert. De focus van je lever verschuift van alcohol verwerken naar het reguleren van je energie. Je kunt je nog wat wankel of zweterig voelen, maar de acute giftigheid neemt af.", icon: "üåü" },
      { day: 2, title: "Systeem reinigt zich", text: "De laatste resten alcohol verlaten je systeem. Je nieren werken effici√´nter en je hydratatie verbetert. Hoofdpijn (door uitdroging) begint weg te trekken.", icon: "üí™" },
      { day: 3, title: "Hangxiety verdwijnt", text: "De beruchte 'hangxiety' (angstgevoelens na drank) ebt weg. Je zenuwstelsel kalmeert. Je bloeddruk begint te normaliseren.", icon: "‚ú®" },
      { day: 4, title: "Spijsvertering herstelt", text: "Je spijsvertering herstelt. Alcohol irriteert het maagslijmvlies; zonder die prikkel neemt je lichaam voedingsstoffen weer beter op.", icon: "üçÉ" },
      { day: 5, title: "Diepere slaap", text: "Je begint beter door te slapen. Hoewel alcohol je helpt inslapen, verpest het de kwaliteit. Na 5 dagen begin je weer in de diepe, herstellende slaapfasen te komen.", icon: "üò¥" },
      { day: 7, title: "REM-slaap herstelt", text: "Je REM-slaap (droomslaap) herstelt zich volledig. Dit is cruciaal voor emotionele verwerking en geheugen. Je hebt meer energie overdag en je mentale focus neemt toe.", icon: "üå±" },
      { day: 10, title: "Frissere huid", text: "Je huid ziet er frisser uit. Alcohol verwijdt de bloedvaten en onttrekt vocht; na 10 dagen zie je minder roodheid en wallen.", icon: "‚ú®" },
      { day: 14, title: "Maagklachten verdwijnen", text: "Brandend maagzuur en reflux nemen significant af. Ook begin je gewicht te verliezen (alcohol bevat veel 'lege' calorie√´n en vertraagt de vetverbranding).", icon: "üåø" },
      { day: 21, title: "Hersenmist verdwijnt", text: "Je concentratievermogen en cognitieve functies verbeteren. Het 'hersenmist'-gevoel verdwijnt doordat de communicatie tussen neuronen weer soepeler verloopt.", icon: "üß†" },
      { day: 30, title: "Lever ontvet", text: "De leververvetting neemt af. Onderzoek toont aan dat na 30 dagen nuchterheid het vetpercentage in de lever met gemiddeld 15% tot 20% kan dalen. Je immuunsysteem wordt sterker.", icon: "üå≥" },
      { day: 60, title: "Hart ontspant", text: "Je bloeddruk is stabieler en je hart hoeft minder hard te werken. Je algemene stressniveau daalt omdat je cortisolspiegel (het stresshormoon) niet meer constant geprikkeld wordt door alcoholgebruik.", icon: "üíö" },
      { day: 90, title: "Bloedbeeld verbetert", text: "Je bloedbeeld verbetert aanzienlijk. Rode bloedcellen zijn gezonder, wat zorgt voor een beter zuurstoftransport. Bij mannen verbetert de spermakwaliteit; bij vrouwen de hormonale balans.", icon: "üèÜ" },
      { day: 180, title: "Brein reset compleet", text: "De neurotransmitters in je brein (zoals dopamine en GABA) zijn gereset. Je bent weer in staat om plezier te beleven aan kleine dingen zonder de 'kick' van alcohol. Je mentale veerkracht is op een hoogtepunt.", icon: "‚≠ê" },
      { day: 270, title: "Lever bijna optimaal", text: "De lever heeft een enorme zelfgenezende capaciteit getoond. Tenzij er sprake was van blijvende littekens (cirrose), functioneert je lever nu weer bijna optimaal. Je weerstand tegen infecties is maximaal.", icon: "üíé" },
      { day: 365, title: "Gezondheidsrisico gehalveerd", text: "Het risico op verschillende soorten kanker (mond, keel, lever, borst) is drastisch verlaagd. Je hart- en vaatziektenrisico is gehalveerd ten opzichte van een zware drinker. Je bent mentaal scherper, fysiek fitter en je hebt waarschijnlijk een aanzienlijk bedrag bespaard.", icon: "üëë" }
    ];

    const sportBenefits = [
      { day: 1, title: "Hydratatie normaliseert", text: "Je hydratatiestatus normaliseert. Alcohol is een diureticum (vochtafdrijvend). Zonder alcohol houdt je lichaam water en elektrolyten (zoals natrium en kalium) beter vast, wat cruciaal is voor spiercontracties en het voorkomen van krampen.", icon: "üíß" },
      { day: 2, title: "Gluconeogenese herstelt", text: "Je lever kan zich weer volledig richten op gluconeogenese (het aanmaken van glucose). Alcohol blokkeert dit proces, waardoor je bloedsuikerspiegel laag kan zijn. Nu heb je weer stabiele energie voor een intensieve training.", icon: "‚ö°" },
      { day: 3, title: "HRV stijgt", text: "Je Heart Rate Variability (HRV) begint te stijgen. Een hogere HRV is een teken dat je zenuwstelsel hersteld is van de stress van alcohol. Je rusthartslag daalt, wat betekent dat je hart effici√´nter pompt.", icon: "‚ù§Ô∏è" },
      { day: 4, title: "Ontstekingen dalen", text: "De ontstekingswaarden in je bloed dalen. Alcohol veroorzaakt systemische ontstekingen. Zonder alcohol herstellen je spieren sneller van microscheurtjes (spierpijn na training).", icon: "üî•" },
      { day: 5, title: "Glycogeenvoorraad optimaliseert", text: "Je glycogeenvoorraden (de brandstof in je spieren) worden effici√´nter aangevuld. Je zult merken dat je tijdens duursporten minder snel 'de man met de hamer' tegenkomt.", icon: "üîã" },
      { day: 7, title: "Groeihormoon piekt", text: "Je slaaparchitectuur verbetert drastisch. Tijdens de diepe slaap maakt je lichaam Groeihormoon (HGH) aan. Alcohol onderdrukt dit hormoon tot wel 70%. Na een week nuchterheid piekt je natuurlijke spierherstel 's nachts.", icon: "üí™" },
      { day: 10, title: "Reactievermogen optimaal", text: "Je reactievermogen en motoriek zijn weer optimaal. Zelfs kleine hoeveelheden alcohol kunnen je balans en oog-handco√∂rdinatie dagenlang subtiel verstoren. Nu ben je scherper tijdens technische sporten of balsporten.", icon: "‚ö°" },
      { day: 14, title: "Vitamine-opname verbetert", text: "Je bloedvolume stabiliseert en de opname van vitamines (zoals B12 en foliumzuur) verbetert. Dit is essentieel voor de aanmaak van rode bloedcellen, die zuurstof naar je spieren transporteren.", icon: "ü©∏" },
      { day: 21, title: "Vetverbranding effici√´nter", text: "Je vetverbranding wordt effici√´nter. Zolang er alcohol in je systeem zit, stopt je lichaam met het verbranden van vet om eerst de ethanol af te breken. Nu begint je lichaam gemakkelijker vetreserves aan te spreken voor energie.", icon: "üî•" },
      { day: 30, title: "Lichaamssamenstelling verbetert", text: "Verbetering van de lichaamssamenstelling. Door het wegvallen van de lege calorie√´n en de afname van oestrogeen-achtige effecten van alcohol, verlies je gemakkelijker visceraal vet (buikvet) en behoud je makkelijker spiermassa.", icon: "üí™" },
      { day: 60, title: "Testosteron-cortisol ratio herstelt", text: "De testosteron-cortisol ratio herstelt zich. Alcohol verhoogt cortisol (stress/spierafbraak) en verlaagt testosteron (spieropbouw). Na 2 maanden ben je in een veel betere 'anabole' staat om echt kracht en spiermassa te winnen.", icon: "üìà" },
      { day: 90, title: "VO2-max verbetert", text: "Je VO2-max (maximale zuurstofopname) verbetert merkbaar. Je longen en hart werken beter samen, waardoor je conditie naar een niveau stijgt dat met alcohol simpelweg niet haalbaar was.", icon: "ü´Å" },
      { day: 180, title: "Collageen synthese verbeterd", text: "De synthese van collageen is verbeterd. Alcohol remt de aanmaak van eiwitten die je pezen en banden sterk houden. Na een half jaar nuchterheid heb je een significant lager risico op blessures aan je gewrichten en pezen.", icon: "ü¶¥" },
      { day: 270, title: "Mentale weerbaarheid groter", text: "Je mentale weerbaarheid (grit) is groter. Je hebt geleerd om te presteren en te ontspannen zonder externe middelen. De 'focus' tijdens wedstrijden is scherper en je ervaart minder prestatie-angst.", icon: "üß†" },
      { day: 365, title: "Volledig metabolisch fundament", text: "Je hebt een volledig nieuw metabolisch fundament. Je immuunsysteem is zo sterk dat je minder trainingsdagen mist door verkoudheid of griep. Je sportprestaties zijn nu gebaseerd op een lichaam dat 100% effici√´nt functioneert, zonder de rem van toxische stoffen.", icon: "üèÜ" }
    ];

    const shopItems = [
      { id: 'beer', name: 'Biertje', icon: 'üç∫', cost: 15 },
      { id: 'wine', name: 'Glas wijn', icon: 'üç∑', cost: 20 },
      { id: 'cocktail', name: 'Cocktail', icon: 'üçπ', cost: 25 }
    ];

    const activeBenefits = sportMode ? sportBenefits : benefits;
    const currentBenefit = activeBenefits.find(b => b.day === timeElapsed.days);

    function updateTime() {
      if (!startDate) return;
      
      const start = new Date(startDate);
      const now = new Date();
      const diff = now - start;
      
      timeElapsed.days = Math.floor(diff / (1000 * 60 * 60 * 24));
      timeElapsed.hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      timeElapsed.minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      timeElapsed.seconds = Math.floor((diff % (1000 * 60)) / 1000);
    }

    function calculatePoints() {
      // 5 punten per dag
      let points = timeElapsed.days * 5;
      
      // Mijlpalen die een bonus geven: 1 week, 2 weken, 1 maand, 3 maanden, 6 maanden, 1 jaar
      const bonusMilestones = [7, 14, 30, 90, 180, 365];
      
      // Check welke mijlpalen zijn behaald en voeg bonussen toe
      let newMilestonesAchieved = false;
      bonusMilestones.forEach(milestoneDays => {
        if (timeElapsed.days >= milestoneDays) {
          if (!achievedMilestones.includes(milestoneDays)) {
            // Nieuwe mijlpaal behaald! Voeg toe aan array
            achievedMilestones.push(milestoneDays);
            newMilestonesAchieved = true;
          }
          // Voeg bonus toe voor deze mijlpaal (5 punten per mijlpaal)
          points += 5;
        }
      });
      
      // Opslaan van behaalde mijlpalen als er nieuwe zijn
      if (newMilestonesAchieved) {
        localStorage.setItem('achievedMilestones', JSON.stringify(achievedMilestones));
      }
      
      // Voeg opgeslagen punten toe
      return points + savedPoints;
    }

    function purchaseDrink(item, quantity) {
      const currentPoints = calculatePoints();
      const totalCost = item.cost * quantity;
      
      if (currentPoints < totalCost) {
        purchaseMessage = 
        purchaseType = 'error';
        purchaseMessage = `Je hebt niet genoeg punten! Je hebt ${currentPoints} punten, maar je hebt ${totalCost} punten nodig.`;
      } else {
        // Bereken hoeveel punten overblijven na aankoop
        const remainingPoints = currentPoints - totalCost;
        
        // Reset naar nu (0 dagen) - zoals de reset functie
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const dateString = `${year}-${month}-${day}T${hours}:${minutes}`;
        
        startDate = dateString;
        localStorage.setItem('sobrietyStartDate', startDate);
        
        // Reset achievedMilestones (nieuwe start)
        achievedMilestones = [];
        localStorage.setItem('achievedMilestones', JSON.stringify(achievedMilestones));
        
        // Bewaar de overgebleven punten
        savedPoints = remainingPoints;
        localStorage.setItem('savedPoints', savedPoints);
        
        // Update purchase history
        purchaseHistory[item.id] = (purchaseHistory[item.id] || 0) + quantity;
        localStorage.setItem('purchaseHistory', JSON.stringify(purchaseHistory));
        
        const itemText = quantity === 1 ? item.name : `${quantity}x ${item.name}`;
        purchaseMessage = `Gefeliciteerd! Je hebt ${itemText} gekocht voor ${totalCost} punten. Geniet ervan! üéâ`;
        purchaseType = 'success';
      }
      
      render();
      
      // Verwijder bericht na 4 seconden
      setTimeout(() => {
        purchaseMessage = '';
        render();
      }, 4000);
    }

    function updateQuantity(itemId, change) {
      shopQuantities[itemId] = Math.max(1, shopQuantities[itemId] + change);
      render();
    }

    function handleSetStartDate(dateString) {
      localStorage.setItem('sobrietyStartDate', dateString);
      startDate = dateString;
      achievedMilestones = []; // Reset mijlpalen bij nieuwe startdatum
      localStorage.setItem('achievedMilestones', JSON.stringify(achievedMilestones));
      savedPoints = 0; // Reset opgeslagen punten bij nieuwe startdatum
      localStorage.setItem('savedPoints', '0');
      showDatePicker = false;
      tempDate = '';
      render();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function handleConfirmDate() {
      if (tempDate) {
        const selectedDate = new Date(tempDate);
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        if (selectedDate > today) {
          alert('Je kunt geen toekomstige datum kiezen!');
        } else {
            handleSetStartDate(tempDate);
        }
      }
    }

    function resetJourney() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const dateString = `${year}-${month}-${day}T${hours}:${minutes}`;
      
      localStorage.setItem('sobrietyStartDate', dateString);
      startDate = dateString;
      achievedMilestones = []; // Reset mijlpalen
      localStorage.setItem('achievedMilestones', JSON.stringify(achievedMilestones));
      savedPoints = 0; // Reset opgeslagen punten
      localStorage.setItem('savedPoints', '0');
      showResetConfirm = false;
      render();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function render() {
      // Toggle body class for sport mode theme
      document.body.classList.toggle('sport-mode', sportMode);
      
      const root = document.getElementById('root');
      
      if (showDatePicker) {
        // Alleen kruisje tonen als we aan het aanpassen zijn (er is al een startDate)
        const closeBtnHtml = startDate ? `
          <button id="closeDatePickerBtn" class="close-button" aria-label="Sluiten" title="Sluiten">
            ‚úï
          </button>
        ` : '';

        root.innerHTML = `
          <div class="center-screen">
            <div class="date-picker-card">
              ${closeBtnHtml}
              <div style="text-align: center;">
                <div class="icon-circle">‚ú®</div>
                <h1 class="title-large">Begin je reis</h1>
                <p class="subtitle">Wanneer begon je nuchtere leven?</p>
              </div>
              
              <input
                type="date"
                id="dateInput"
                class="input-datetime"
                max="${new Date().toISOString().slice(0, 10)}"
              />
              
              <button id="confirmBtn" class="button-primary" disabled>
                Begin mijn reis
              </button>
              
              <div class="text-small">
                Je kunt dit later altijd aanpassen
              </div>
            </div>
          </div>
        `;
        
        const dateInput = document.getElementById('dateInput');
        const confirmBtn = document.getElementById('confirmBtn');
        const closeBtn = document.getElementById('closeDatePickerBtn');
        
        dateInput.addEventListener('input', (e) => {
          tempDate = e.target.value;
          confirmBtn.disabled = !tempDate;
        });
        
        confirmBtn.addEventListener('click', handleConfirmDate);
        
        if (closeBtn) {
          closeBtn.addEventListener('click', () => {
            showDatePicker = false;
            tempDate = '';
            render();
          });
        }
        
      } else {
        updateTime();
        const nextMilestone = milestones.find(m => m.days > timeElapsed.days);
        const totalPoints = calculatePoints();
        
        // LET OP: Hier is de inline style verwijderd en vervangen door class="header-controls"
        root.innerHTML = `
          <div>
            <div class="header">
              <div class="header-content">
                <h1 class="header-title">More Sober Days</h1>
                <div class="header-controls">
                  <div class="mode-toggle-container">
                    <span class="mode-toggle-label">
                      <span style="font-size: 1.25rem;">üèÉ</span>
                      <span>Sportmodus</span>
                    </span>
                    <div id="modeToggle" class="toggle-switch ${sportMode ? 'active' : ''}">
                      <div class="toggle-slider"></div>
                    </div>
                  </div>
                  <div class="mode-toggle-container">
                    <span class="mode-toggle-label">
                      <span style="font-size: 1.25rem;">üõí</span>
                      <span>Drank-winkel</span>
                    </span>
                    <div id="shopToggle" class="toggle-switch ${showShop ? 'active' : ''}">
                      <div class="toggle-slider"></div>
                    </div>
                  </div>
                  <button id="editBtn" class="header-button">
                    üìÖ Aanpassen
                  </button>
                </div>
              </div>
            </div>

            <div class="container space-y">
              <div class="card card-hover">
                <div style="text-align: center; margin-bottom: 1.5rem;">
                  <div class="icon-circle-small">üìà</div>
                  <h2 class="counter-title">Nuchter sinds</h2>
                </div>
                
                <div class="counter-grid">
                  <div class="counter-item">
                    <div class="counter-number counter-number-green">
                      ${timeElapsed.days}
                    </div>
                    <div class="counter-label">
                      ${timeElapsed.days === 1 ? 'Dag' : 'Dagen'}
                    </div>
                  </div>
                  <div class="counter-item">
                    <div class="counter-number counter-number-teal">
                      ${totalPoints}
                    </div>
                    <div class="counter-label">
                      Punten
                    </div>
                  </div>
                </div>

                ${nextMilestone ? `
                  <div class="divider">
                    <p class="next-milestone-label">Volgende mijlpaal</p>
                    <div class="next-milestone-content">
                      <span class="milestone-icon">${nextMilestone.icon}</span>
                      <span class="milestone-title">${nextMilestone.title}</span>
                      <span class="milestone-remaining">
                        (nog ${nextMilestone.days - timeElapsed.days} ${nextMilestone.days - timeElapsed.days === 1 ? 'dag' : 'dagen'})
                      </span>
                    </div>
                  </div>
                ` : ''}
              </div>

              ${currentBenefit ? `
                <div class="benefit-card">
                  <div class="benefit-content">
                    <div class="icon-white">‚ú®</div>
                    <div class="benefit-text">
                      <h3 class="benefit-title">
                        ${currentBenefit.title}
                      </h3>
                      <p class="benefit-description">
                        ${currentBenefit.text}
                      </p>
                    </div>
                  </div>
                </div>
              ` : ''}

              ${showShop ? `
              <div class="card">
                <div class="section-header">
                  <span style="font-size: 1.5rem;">üõí</span>
                  <h3 class="section-title">Drank-winkel</h3>
                </div>
                <p style="color: #6b7280; margin-bottom: 1.5rem; text-align: center;">
                  Wissel je punten in voor een drankje
                </p>
                
                ${purchaseMessage ? `
                  <div class="purchase-message purchase-${purchaseType}">
                    ${purchaseMessage}
                  </div>
                ` : ''}
                
                <div class="shop-grid">
                  ${shopItems.map(item => {
                    const quantity = shopQuantities[item.id];
                    const totalCost = item.cost * quantity;
                    const purchased = purchaseHistory[item.id] || 0;
                    return `
                    <div class="shop-item">
                      <div class="shop-item-icon">${item.icon}</div>
                      <div class="shop-item-name">${item.name}</div>
                      <div class="shop-item-cost">${item.cost} punten</div>
                      ${purchased > 0 ? `<div style="color: #9ca3af; font-size: 0.75rem; margin-bottom: 0.5rem;">Al ${purchased}x gekocht</div>` : ''}
                      <div class="quantity-control">
                        <button class="quantity-button" data-item-id="${item.id}" data-action="decrease" ${quantity <= 1 ? 'disabled' : ''}>‚àí</button>
                        <div class="quantity-display">${quantity}</div>
                        <button class="quantity-button" data-item-id="${item.id}" data-action="increase">+</button>
                      </div>
                      <div style="color: #6b7280; font-size: 0.875rem; margin-bottom: 0.75rem;">
                        Totaal: ${totalCost} punten
                      </div>
                      <button 
                        class="shop-button" 
                        data-item-id="${item.id}"
                        ${totalPoints < totalCost ? 'disabled' : ''}
                      >
                        ${totalPoints < totalCost ? 'Te weinig punten' : 'Koop'}
                      </button>
                    </div>
                  `}).join('')}
                </div>
              </div>
              ` : ''}

              <div class="card">
                <div class="section-header">
                  <span style="font-size: 1.5rem;">üèÜ</span>
                  <h3 class="section-title">Behaalde Mijlpalen</h3>
                </div>
                
                <div class="milestone-grid">
                  ${milestones.map((milestone) => {
                    const achieved = timeElapsed.days >= milestone.days;
                    const activeBenefits = sportMode ? sportBenefits : benefits;
                    const benefit = activeBenefits.find(b => b.day === milestone.days);
                    const bonusMilestones = [7, 14, 30, 90, 180, 365];
                    const hasBonus = bonusMilestones.includes(milestone.days);
                    return `
                      <div class="milestone-card ${achieved ? 'milestone-achieved' : 'milestone-pending'}">
                        <div class="milestone-header">
                          <div class="milestone-emoji">${milestone.icon}</div>
                          <div class="milestone-name">${milestone.title}</div>
                          ${achieved ? `<div class="milestone-badge">‚úì Behaald${hasBonus ? ' +5 punten' : ''}</div>` : ''}
                        </div>
                        ${benefit && achieved ? `
                          <div class="milestone-benefit">
                            <div class="milestone-benefit-title">${benefit.title}</div>
                            <div class="milestone-benefit-text">${benefit.text}</div>
                          </div>
                        ` : ''}
                      </div>
                    `;
                  }).join('')}
                </div>
              </div>

              <div class="reset-card">
                <h3 class="reset-title">Opnieuw beginnen?</h3>
                ${!showResetConfirm ? `
                  <button id="resetBtn" class="button-danger">
                    Reis opnieuw beginnen
                  </button>
                  <p class="text-small">Dit zet je startdatum op nu</p>
                ` : `
                  <div>
                    <p class="confirm-text">Weet je het zeker? Dit zet je startdatum op nu.</p>
                    <div class="button-group">
                      <button id="confirmResetBtn" class="button-confirm">
                        Ja, opnieuw beginnen
                      </button>
                      <button id="cancelResetBtn" class="button-cancel">
                        Annuleren
                      </button>
                    </div>
                  </div>
                `}
              </div>
            </div>
          </div>
        `;
        
        document.getElementById('editBtn').addEventListener('click', () => {
          showDatePicker = true;
          render();
        });
        
        document.getElementById('modeToggle').addEventListener('click', () => {
          sportMode = !sportMode;
          localStorage.setItem('sportMode', sportMode);
          render();
        });
        
        document.getElementById('shopToggle').addEventListener('click', () => {
          showShop = !showShop;
          localStorage.setItem('showShop', showShop);
          render();
        });
        
        // Shop button event listeners
        document.querySelectorAll('.quantity-button').forEach(button => {
          button.addEventListener('click', (e) => {
            const itemId = e.target.dataset.itemId;
            const action = e.target.dataset.action;
            const change = action === 'increase' ? 1 : -1;
            updateQuantity(itemId, change);
          });
        });

        document.querySelectorAll('.shop-button').forEach(button => {
          button.addEventListener('click', (e) => {
            const itemId = e.target.dataset.itemId;
            const item = shopItems.find(i => i.id === itemId);
            const quantity = shopQuantities[itemId];
            if (item) {
              purchaseDrink(item, quantity);
            }
          });
        });
        
        const resetBtn = document.getElementById('resetBtn');
        if (resetBtn) {
          resetBtn.addEventListener('click', () => {
            showResetConfirm = true;
            render();
          });
        }
        
        const confirmResetBtn = document.getElementById('confirmResetBtn');
        if (confirmResetBtn) {
          confirmResetBtn.addEventListener('click', resetJourney);
        }
        
        const cancelResetBtn = document.getElementById('cancelResetBtn');
        if (cancelResetBtn) {
          cancelResetBtn.addEventListener('click', () => {
            showResetConfirm = false;
            render();
          });
        }
      }
    }

    // Initial render
    render();

    // Update time every second
    if (startDate) {
      setInterval(() => {
        if (!showDatePicker) {
          updateTime();
          // Update only the time display without full re-render
          const days = document.querySelector('.counter-number-green');
          
          if (days) days.textContent = timeElapsed.days;
        }
      }, 1000);
    }
  </script>
</body>
</html>